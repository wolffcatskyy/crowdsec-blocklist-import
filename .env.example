# CrowdSec Blocklist Import - Environment Configuration
# Copy this file to .env and customize as needed

# =============================================================================
# Required Settings
# =============================================================================

# CrowdSec LAPI URL (your CrowdSec instance)
CROWDSEC_LAPI_URL=http://localhost:8080

# CrowdSec LAPI Key (for reading existing decisions)
# Generate with: cscli bouncers add blocklist-import -o raw
CROWDSEC_LAPI_KEY=your_bouncer_api_key_here

# Machine credentials (required for writing decisions)
# Option 1: Use existing machine credentials from /etc/crowdsec/local_api_credentials.yaml
# Option 2: Create a new machine: cscli machines add blocklist-import --password 'YourSecurePassword'
CROWDSEC_MACHINE_ID=blocklist-import
CROWDSEC_MACHINE_PASSWORD=YourSecurePassword

# =============================================================================
# Decision Settings
# =============================================================================

# How long decisions last (refresh daily with 24h)
DECISION_DURATION=24h

# Decision reason (visible in cscli decisions list)
DECISION_REASON=external_blocklist

# Decision type (ban, captcha, throttle)
DECISION_TYPE=ban

# Decision origin (for filtering)
DECISION_ORIGIN=blocklist-import

# Decision scenario (for filtering)
DECISION_SCENARIO=external/blocklist

# =============================================================================
# Processing Settings
# =============================================================================

# Number of IPs to import per batch (memory vs. speed tradeoff)
BATCH_SIZE=1000

# Timeout for fetching each blocklist (seconds)
FETCH_TIMEOUT=60

# Max retries for failed HTTP requests
MAX_RETRIES=3

# =============================================================================
# Logging
# =============================================================================

# Log level: DEBUG, INFO, WARN, ERROR
LOG_LEVEL=INFO

# =============================================================================
# Telemetry
# =============================================================================

# Anonymous usage telemetry (set to false to disable)
TELEMETRY_ENABLED=true

# =============================================================================
# Blocklist Enables (all true by default)
# Set to false to disable specific blocklists
# =============================================================================

# Aggregated threat intel (IPs on 3+ blocklists)
ENABLE_IPSUM=true

# Spamhaus DROP/EDROP (known hijacked netblocks)
ENABLE_SPAMHAUS=true

# Blocklist.de (all/ssh/apache/mail)
ENABLE_BLOCKLIST_DE=true

# Firehol level1 and level2
ENABLE_FIREHOL=true

# Abuse.ch (Feodo, SSL Blacklist, URLhaus)
ENABLE_ABUSE_CH=true

# Emerging Threats compromised IPs
ENABLE_EMERGING_THREATS=true

# Binary Defense ban list
ENABLE_BINARY_DEFENSE=true

# Bruteforce Blocker
ENABLE_BRUTEFORCE_BLOCKER=true

# DShield top attackers
ENABLE_DSHIELD=true

# CI Army bad reputation
ENABLE_CI_ARMY=true

# Darklist SSH brute force
ENABLE_DARKLIST=true

# Talos Intelligence
ENABLE_TALOS=true

# Charles Haley SSH attacks
ENABLE_CHARLES_HALEY=true

# Botvrij botnet C2
ENABLE_BOTVRIJ=true

# myip.ms blacklist
ENABLE_MYIP_MS=true

# GreenSnow attacker IPs
ENABLE_GREENSNOW=true

# StopForumSpam toxic IPs
ENABLE_STOPFORUMSPAM=true

# Tor exit nodes (may cause false positives for Tor users)
ENABLE_TOR=true

# Scanner IPs (Shodan, Censys)
ENABLE_SCANNERS=true
