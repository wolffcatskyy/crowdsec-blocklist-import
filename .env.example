# CrowdSec Blocklist Import - Environment Configuration
# Copy this file to .env and customize as needed

# =============================================================================
# Required Settings
# =============================================================================

# CrowdSec LAPI URL (your CrowdSec instance)
CROWDSEC_LAPI_URL=http://localhost:8080

# CrowdSec LAPI Key (for reading existing decisions)
# Generate with: cscli bouncers add blocklist-import -o raw
CROWDSEC_LAPI_KEY=your_bouncer_api_key_here
# or: CROWDSEC_LAPI_KEY_FILE=your_bouncer_api_key_file_path_here

# Machine credentials (required for writing decisions)
# Option 1: Use existing machine credentials from /etc/crowdsec/local_api_credentials.yaml
# Option 2: Create a new machine: cscli machines add blocklist-import --password 'YourSecurePassword'
CROWDSEC_MACHINE_ID=blocklist-import
CROWDSEC_MACHINE_PASSWORD=YourSecurePassword
# or: CROWDSEC_MACHINE_PASSWORD_FILE=local_api_credentials_file_path

# =============================================================================
# Decision Settings
# =============================================================================

# How long decisions last (refresh daily with 24h)
DECISION_DURATION=24h

# Decision reason (visible in cscli decisions list)
DECISION_REASON=external_blocklist

# Decision type (ban, captcha, throttle)
DECISION_TYPE=ban

# Decision origin (for filtering)
DECISION_ORIGIN=blocklist-import

# Decision scenario (for filtering)
DECISION_SCENARIO=external/blocklist

# Allowlist - comma-separated IPs and/or CIDR ranges to exclude from bans
# Supports both individual IPs and CIDR notation for range matching
# Examples:
#   ALLOWLIST=1.2.3.4,5.6.7.8                    # Individual IPs
#   ALLOWLIST=140.82.112.0/20,185.199.108.0/22   # CIDR ranges
#   ALLOWLIST=1.2.3.4,140.82.112.0/20            # Mixed
ALLOWLIST=140.82.121.3,140.82.121.4

# Provider allowlists - auto-fetch IP ranges from well-known providers
# ALLOWLIST_GITHUB: Fetches GitHub's IP ranges from https://api.github.com/meta
#   Covers: git, web, api, hooks, and actions IP ranges
#   Falls back to hardcoded ranges if API is unreachable
ALLOWLIST_GITHUB=false

LOG_TIMESTAMPS=true

# =============================================================================
# Processing Settings
# =============================================================================

# Number of IPs to import per batch (memory vs. speed tradeoff)
BATCH_SIZE=1000

# Timeout for fetching each blocklist (seconds)
FETCH_TIMEOUT=60

# Max retries for failed HTTP requests
MAX_RETRIES=3

# Dry run
# DRY_RUN=1

# =============================================================================
# Logging
# =============================================================================

# Log level: DEBUG, INFO, WARN, ERROR
LOG_LEVEL=INFO

# =============================================================================
# Telemetry
# =============================================================================

# Anonymous usage telemetry (set to false to disable)
TELEMETRY_ENABLED=true

# =============================================================================
# Blocklist Enables (all true by default)
# Set to false to disable specific blocklists
# =============================================================================

# Aggregated threat intel (IPs on 3+ blocklists)
ENABLE_IPSUM=true

# Spamhaus DROP (known hijacked netblocks)
ENABLE_SPAMHAUS=true

# Blocklist.de (all/ssh/apache/mail)
ENABLE_BLOCKLIST_DE=true

# Firehol level1 and level2
ENABLE_FIREHOL=true

# Abuse.ch (Feodo, URLhaus)
ENABLE_ABUSE_CH=true

# Emerging Threats compromised IPs
ENABLE_EMERGING_THREATS=true

# Binary Defense ban list
ENABLE_BINARY_DEFENSE=true

# Bruteforce Blocker
ENABLE_BRUTEFORCE_BLOCKER=true

# DShield top attackers
ENABLE_DSHIELD=true

# CI Army bad reputation
ENABLE_CI_ARMY=true

# Botvrij botnet C2
ENABLE_BOTVRIJ=true

# GreenSnow attacker IPs
ENABLE_GREENSNOW=true

# StopForumSpam toxic IPs
ENABLE_STOPFORUMSPAM=true

# Tor exit nodes (may cause false positives for Tor users)
ENABLE_TOR=true

# Scanner IPs (Shodan, Censys)
ENABLE_SCANNERS=true

ENABLE_ABUSE_IPDB=true

ENABLE_CYBERCRIME_TRACKER=true

ENABLE_MONTY_SECURITY_C2=true

ENABLE_VXVAULT=true

